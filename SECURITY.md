# 🔒 仓库管理系统安全配置

## 🛡️ 安全特性

### 1. 用户认证系统
- **JWT令牌认证** - 安全的无状态认证
- **令牌过期机制** - 24小时自动过期
- **自动令牌验证** - 每次请求验证令牌有效性
- **安全登出** - 服务器端记录登出日志

### 2. 权限控制系统
- **基于角色的访问控制 (RBAC)**
- **细粒度权限管理**
- **API端点保护**
- **前端权限检查**

## 👥 用户角色和权限

### 管理员 (admin)
- ✅ 所有数据查看权限
- ✅ 所有数据创建权限
- ✅ 所有数据更新权限
- ✅ 所有数据删除权限
- ✅ 用户管理权限
- ✅ 报告查看和导出权限
- ✅ 系统设置权限

### 操作员 (operator)
- ✅ 数据查看权限
- ✅ 数据创建权限
- ✅ 数据更新权限
- ❌ 数据删除权限
- ❌ 用户管理权限
- ✅ 报告查看权限
- ❌ 系统设置权限

### 查看者 (viewer)
- ✅ 数据查看权限
- ❌ 数据创建权限
- ❌ 数据更新权限
- ❌ 数据删除权限
- ❌ 用户管理权限
- ✅ 报告查看权限
- ❌ 系统设置权限

## 🔐 安全配置

### 环境变量配置

#### 后端环境变量
```bash
# JWT密钥（生产环境必须更改）
JWT_SECRET=your-super-secret-jwt-key-change-in-production

# 数据库连接
DATABASE_URL=postgresql://user:pass@host:port/db

# 服务器配置
PORT=4000
NODE_ENV=production

# 前端URL（CORS配置）
FRONTEND_URL=https://your-frontend-domain.vercel.app
```

#### 前端环境变量
```bash
# API地址
REACT_APP_API_URL=https://your-backend.railway.app
```

### 数据库安全
- **密码加密存储** - 使用bcrypt加密
- **SQL注入防护** - 使用参数化查询
- **连接池管理** - 限制并发连接数
- **SSL连接** - 生产环境强制SSL

### API安全
- **CORS配置** - 限制跨域访问
- **请求大小限制** - 防止DoS攻击
- **文件上传限制** - 限制文件类型和大小
- **错误信息过滤** - 不暴露敏感信息

## 🚨 安全最佳实践

### 1. 生产环境配置
```bash
# 更改默认JWT密钥
JWT_SECRET=your-very-long-random-secret-key-at-least-32-characters

# 使用HTTPS
FRONTEND_URL=https://your-domain.com
```

### 2. 用户密码策略
- 建议密码长度至少8位
- 包含大小写字母、数字和特殊字符
- 定期更换密码

### 3. 访问控制
- 定期审查用户权限
- 及时删除离职用户账户
- 监控异常登录行为

### 4. 数据保护
- 定期备份数据库
- 加密敏感数据传输
- 限制数据导出权限

## 🔍 安全监控

### 日志记录
- 用户登录/登出记录
- API访问日志
- 错误和异常记录
- 权限检查失败记录

### 监控指标
- 登录失败次数
- API访问频率
- 异常请求模式
- 系统性能指标

## 🛠️ 安全更新

### 定期更新
- 依赖包安全更新
- 系统补丁更新
- 安全配置审查

### 安全审计
- 权限配置检查
- 访问日志分析
- 安全漏洞扫描

## 📋 安全检查清单

### 部署前检查
- [ ] 更改默认JWT密钥
- [ ] 配置HTTPS
- [ ] 设置强密码策略
- [ ] 配置CORS
- [ ] 启用数据库SSL
- [ ] 设置文件上传限制

### 运行时检查
- [ ] 监控登录异常
- [ ] 检查API访问日志
- [ ] 验证权限控制
- [ ] 测试令牌过期
- [ ] 验证登出功能

## 🆘 安全事件响应

### 发现安全问题时
1. **立即隔离** - 暂停相关服务
2. **评估影响** - 确定影响范围
3. **修复漏洞** - 应用安全补丁
4. **通知用户** - 告知安全事件
5. **加强监控** - 增加安全监控

### 联系方式
- 技术支持：security@yourcompany.com
- 紧急联系：+86-xxx-xxxx-xxxx

---

**⚠️ 重要提醒：**
- 生产环境部署前必须更改所有默认密码和密钥
- 定期进行安全审计和更新
- 保持系统依赖包的最新版本
- 监控系统访问日志，及时发现异常行为
